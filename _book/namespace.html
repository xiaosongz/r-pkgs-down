<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 8 Namespace | R packages</title>
  <meta name="description" content="This is the book site for “R packages”.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 8 Namespace | R packages" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://r-pkgs.xiaosongz.com" />
  <meta property="og:image" content="https://r-pkgs.xiaosongz.comimages/cover.png" />
  <meta property="og:description" content="This is the book site for “R packages”." />
  <meta name="github-repo" content="hadley/r-pkgs" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Namespace | R packages" />
  
  <meta name="twitter:description" content="This is the book site for “R packages”." />
  <meta name="twitter:image" content="https://r-pkgs.xiaosongz.comimages/cover.png" />

<meta name="author" content="Hadley Wickham">


<meta name="date" content="2019-01-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="tests.html">
<link rel="next" href="data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R packages by Hadley Wickham</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>R packages</a></li>
<li class="chapter" data-level="1" data-path="intro-why.html"><a href="intro-why.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro-why.html"><a href="intro-why.html#intro-phil"><i class="fa fa-check"></i><b>1.1</b> Philosophy</a></li>
<li class="chapter" data-level="1.2" data-path="intro-why.html"><a href="intro-why.html#intro-outline"><i class="fa fa-check"></i><b>1.2</b> In this book</a></li>
<li class="chapter" data-level="1.3" data-path="intro-why.html"><a href="intro-why.html#intro-get"><i class="fa fa-check"></i><b>1.3</b> Getting started</a></li>
<li class="chapter" data-level="1.4" data-path="intro-why.html"><a href="intro-why.html#intro-ack"><i class="fa fa-check"></i><b>1.4</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.5" data-path="intro-why.html"><a href="intro-why.html#intro-conventions"><i class="fa fa-check"></i><b>1.5</b> Conventions</a></li>
<li class="chapter" data-level="1.6" data-path="intro-why.html"><a href="intro-why.html#intro-colophon"><i class="fa fa-check"></i><b>1.6</b> Colophon</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="package-structure.html"><a href="package-structure.html"><i class="fa fa-check"></i><b>2</b> Package structure</a><ul>
<li class="chapter" data-level="2.1" data-path="package-structure.html"><a href="package-structure.html#naming"><i class="fa fa-check"></i><b>2.1</b> Naming your package</a><ul>
<li class="chapter" data-level="2.1.1" data-path="package-structure.html"><a href="package-structure.html#requirements-for-a-name"><i class="fa fa-check"></i><b>2.1.1</b> Requirements for a name</a></li>
<li class="chapter" data-level="2.1.2" data-path="package-structure.html"><a href="package-structure.html#strategies-for-creating-a-name"><i class="fa fa-check"></i><b>2.1.2</b> Strategies for creating a name</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="package-structure.html"><a href="package-structure.html#getting-started"><i class="fa fa-check"></i><b>2.2</b> Creating a package</a></li>
<li class="chapter" data-level="2.3" data-path="package-structure.html"><a href="package-structure.html#projects"><i class="fa fa-check"></i><b>2.3</b> RStudio projects</a><ul>
<li class="chapter" data-level="2.3.1" data-path="package-structure.html"><a href="package-structure.html#what-is-an-rstudio-project-file"><i class="fa fa-check"></i><b>2.3.1</b> What is an RStudio project file?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="package-structure.html"><a href="package-structure.html#package"><i class="fa fa-check"></i><b>2.4</b> What is a package?</a><ul>
<li class="chapter" data-level="2.4.1" data-path="package-structure.html"><a href="package-structure.html#source-packages"><i class="fa fa-check"></i><b>2.4.1</b> Source packages</a></li>
<li class="chapter" data-level="2.4.2" data-path="package-structure.html"><a href="package-structure.html#bundled-packages"><i class="fa fa-check"></i><b>2.4.2</b> Bundled packages</a></li>
<li class="chapter" data-level="2.4.3" data-path="package-structure.html"><a href="package-structure.html#binary-packages"><i class="fa fa-check"></i><b>2.4.3</b> Binary packages</a></li>
<li class="chapter" data-level="2.4.4" data-path="package-structure.html"><a href="package-structure.html#install"><i class="fa fa-check"></i><b>2.4.4</b> Installed packages</a></li>
<li class="chapter" data-level="2.4.5" data-path="package-structure.html"><a href="package-structure.html#in-memory-packages"><i class="fa fa-check"></i><b>2.4.5</b> In memory packages</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="package-structure.html"><a href="package-structure.html#library"><i class="fa fa-check"></i><b>2.5</b> What is a library?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>3</b> R code</a><ul>
<li class="chapter" data-level="3.1" data-path="r.html"><a href="r.html#r-workflow"><i class="fa fa-check"></i><b>3.1</b> R code workflow</a></li>
<li class="chapter" data-level="3.2" data-path="r.html"><a href="r.html#r-organising"><i class="fa fa-check"></i><b>3.2</b> Organising your functions</a></li>
<li class="chapter" data-level="3.3" data-path="r.html"><a href="r.html#style"><i class="fa fa-check"></i><b>3.3</b> Code style</a><ul>
<li class="chapter" data-level="3.3.1" data-path="r.html"><a href="r.html#object-names"><i class="fa fa-check"></i><b>3.3.1</b> Object names</a></li>
<li class="chapter" data-level="3.3.2" data-path="r.html"><a href="r.html#spacing"><i class="fa fa-check"></i><b>3.3.2</b> Spacing</a></li>
<li class="chapter" data-level="3.3.3" data-path="r.html"><a href="r.html#curly-braces"><i class="fa fa-check"></i><b>3.3.3</b> Curly braces</a></li>
<li class="chapter" data-level="3.3.4" data-path="r.html"><a href="r.html#line-length"><i class="fa fa-check"></i><b>3.3.4</b> Line length</a></li>
<li class="chapter" data-level="3.3.5" data-path="r.html"><a href="r.html#indentation"><i class="fa fa-check"></i><b>3.3.5</b> Indentation</a></li>
<li class="chapter" data-level="3.3.6" data-path="r.html"><a href="r.html#assignment"><i class="fa fa-check"></i><b>3.3.6</b> Assignment</a></li>
<li class="chapter" data-level="3.3.7" data-path="r.html"><a href="r.html#commenting-guidelines"><i class="fa fa-check"></i><b>3.3.7</b> Commenting guidelines</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r.html"><a href="r.html#r-differences"><i class="fa fa-check"></i><b>3.4</b> Top-level code</a><ul>
<li class="chapter" data-level="3.4.1" data-path="r.html"><a href="r.html#loading-code"><i class="fa fa-check"></i><b>3.4.1</b> Loading code</a></li>
<li class="chapter" data-level="3.4.2" data-path="r.html"><a href="r.html#the-r-landscape"><i class="fa fa-check"></i><b>3.4.2</b> The R landscape</a></li>
<li class="chapter" data-level="3.4.3" data-path="r.html"><a href="r.html#when-you-do-need-side-effects"><i class="fa fa-check"></i><b>3.4.3</b> When you <strong>do</strong> need side-effects</a></li>
<li class="chapter" data-level="3.4.4" data-path="r.html"><a href="r.html#s4-classes-generics-and-methods"><i class="fa fa-check"></i><b>3.4.4</b> S4 classes, generics and methods</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="r.html"><a href="r.html#r-cran"><i class="fa fa-check"></i><b>3.5</b> CRAN notes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="description.html"><a href="description.html"><i class="fa fa-check"></i><b>4</b> Package metadata</a><ul>
<li class="chapter" data-level="4.1" data-path="description.html"><a href="description.html#dependencies"><i class="fa fa-check"></i><b>4.1</b> Dependencies: What does your package need?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="description.html"><a href="description.html#versioning"><i class="fa fa-check"></i><b>4.1.1</b> Versioning</a></li>
<li class="chapter" data-level="4.1.2" data-path="description.html"><a href="description.html#other-dependencies"><i class="fa fa-check"></i><b>4.1.2</b> Other dependencies</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="description.html"><a href="description.html#pkg-description"><i class="fa fa-check"></i><b>4.2</b> Title and description: What does your package do?</a></li>
<li class="chapter" data-level="4.3" data-path="description.html"><a href="description.html#author"><i class="fa fa-check"></i><b>4.3</b> Author: who are you?</a><ul>
<li class="chapter" data-level="4.3.1" data-path="description.html"><a href="description.html#on-cran"><i class="fa fa-check"></i><b>4.3.1</b> On CRAN</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="description.html"><a href="description.html#license"><i class="fa fa-check"></i><b>4.4</b> License: Who can use your package?</a><ul>
<li class="chapter" data-level="4.4.1" data-path="description.html"><a href="description.html#on-cran-1"><i class="fa fa-check"></i><b>4.4.1</b> On CRAN</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="description.html"><a href="description.html#version"><i class="fa fa-check"></i><b>4.5</b> Version</a></li>
<li class="chapter" data-level="4.6" data-path="description.html"><a href="description.html#description-misc"><i class="fa fa-check"></i><b>4.6</b> Other components</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="man.html"><a href="man.html"><i class="fa fa-check"></i><b>5</b> Object documentation</a><ul>
<li class="chapter" data-level="5.1" data-path="man.html"><a href="man.html#man-workflow"><i class="fa fa-check"></i><b>5.1</b> The documentation workflow</a></li>
<li class="chapter" data-level="5.2" data-path="man.html"><a href="man.html#man-workflow-2"><i class="fa fa-check"></i><b>5.2</b> Alternative documentation workflow</a></li>
<li class="chapter" data-level="5.3" data-path="man.html"><a href="man.html#roxygen-comments"><i class="fa fa-check"></i><b>5.3</b> Roxygen comments</a></li>
<li class="chapter" data-level="5.4" data-path="man.html"><a href="man.html#man-functions"><i class="fa fa-check"></i><b>5.4</b> Documenting functions</a></li>
<li class="chapter" data-level="5.5" data-path="man.html"><a href="man.html#man-data"><i class="fa fa-check"></i><b>5.5</b> Documenting datasets</a></li>
<li class="chapter" data-level="5.6" data-path="man.html"><a href="man.html#man-packages"><i class="fa fa-check"></i><b>5.6</b> Documenting packages</a></li>
<li class="chapter" data-level="5.7" data-path="man.html"><a href="man.html#man-classes"><i class="fa fa-check"></i><b>5.7</b> Documenting classes, generics and methods</a><ul>
<li class="chapter" data-level="5.7.1" data-path="man.html"><a href="man.html#man-s3"><i class="fa fa-check"></i><b>5.7.1</b> S3</a></li>
<li class="chapter" data-level="5.7.2" data-path="man.html"><a href="man.html#man-s4"><i class="fa fa-check"></i><b>5.7.2</b> S4</a></li>
<li class="chapter" data-level="5.7.3" data-path="man.html"><a href="man.html#man-rc"><i class="fa fa-check"></i><b>5.7.3</b> RC</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="man.html"><a href="man.html#man-special"><i class="fa fa-check"></i><b>5.8</b> Special characters</a></li>
<li class="chapter" data-level="5.9" data-path="man.html"><a href="man.html#dry2"><i class="fa fa-check"></i><b>5.9</b> Do repeat yourself</a><ul>
<li class="chapter" data-level="5.9.1" data-path="man.html"><a href="man.html#inheriting-parameters-from-other-functions"><i class="fa fa-check"></i><b>5.9.1</b> Inheriting parameters from other functions</a></li>
<li class="chapter" data-level="5.9.2" data-path="man.html"><a href="man.html#multiple-man"><i class="fa fa-check"></i><b>5.9.2</b> Documenting multiple functions in the same file</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="man.html"><a href="man.html#text-formatting"><i class="fa fa-check"></i><b>5.10</b> Text formatting reference sheet</a><ul>
<li class="chapter" data-level="5.10.1" data-path="man.html"><a href="man.html#character-formatting"><i class="fa fa-check"></i><b>5.10.1</b> Character formatting</a></li>
<li class="chapter" data-level="5.10.2" data-path="man.html"><a href="man.html#links"><i class="fa fa-check"></i><b>5.10.2</b> Links</a></li>
<li class="chapter" data-level="5.10.3" data-path="man.html"><a href="man.html#lists"><i class="fa fa-check"></i><b>5.10.3</b> Lists</a></li>
<li class="chapter" data-level="5.10.4" data-path="man.html"><a href="man.html#mathematics"><i class="fa fa-check"></i><b>5.10.4</b> Mathematics</a></li>
<li class="chapter" data-level="5.10.5" data-path="man.html"><a href="man.html#tables"><i class="fa fa-check"></i><b>5.10.5</b> Tables</a></li>
<li class="chapter" data-level="5.10.6" data-path="man.html"><a href="man.html#notes"><i class="fa fa-check"></i><b>5.10.6</b> Notes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vignettes.html"><a href="vignettes.html"><i class="fa fa-check"></i><b>6</b> Vignettes: long-form documentation</a><ul>
<li class="chapter" data-level="6.1" data-path="vignettes.html"><a href="vignettes.html#vignette-workflow"><i class="fa fa-check"></i><b>6.1</b> Vignette workflow</a></li>
<li class="chapter" data-level="6.2" data-path="vignettes.html"><a href="vignettes.html#vignette-metadata"><i class="fa fa-check"></i><b>6.2</b> Metadata</a></li>
<li class="chapter" data-level="6.3" data-path="vignettes.html"><a href="vignettes.html#markdown"><i class="fa fa-check"></i><b>6.3</b> Markdown</a><ul>
<li class="chapter" data-level="6.3.1" data-path="vignettes.html"><a href="vignettes.html#sections"><i class="fa fa-check"></i><b>6.3.1</b> Sections</a></li>
<li class="chapter" data-level="6.3.2" data-path="vignettes.html"><a href="vignettes.html#lists-1"><i class="fa fa-check"></i><b>6.3.2</b> Lists</a></li>
<li class="chapter" data-level="6.3.3" data-path="vignettes.html"><a href="vignettes.html#inline-formatting"><i class="fa fa-check"></i><b>6.3.3</b> Inline formatting</a></li>
<li class="chapter" data-level="6.3.4" data-path="vignettes.html"><a href="vignettes.html#tables-1"><i class="fa fa-check"></i><b>6.3.4</b> Tables</a></li>
<li class="chapter" data-level="6.3.5" data-path="vignettes.html"><a href="vignettes.html#code"><i class="fa fa-check"></i><b>6.3.5</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="vignettes.html"><a href="vignettes.html#knitr"><i class="fa fa-check"></i><b>6.4</b> Knitr</a><ul>
<li class="chapter" data-level="6.4.1" data-path="vignettes.html"><a href="vignettes.html#options"><i class="fa fa-check"></i><b>6.4.1</b> Options</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="vignettes.html"><a href="vignettes.html#vignette-workflow-2"><i class="fa fa-check"></i><b>6.5</b> Development cycle</a></li>
<li class="chapter" data-level="6.6" data-path="vignettes.html"><a href="vignettes.html#vignette-advice"><i class="fa fa-check"></i><b>6.6</b> Advice for writing vignettes</a><ul>
<li class="chapter" data-level="6.6.1" data-path="vignettes.html"><a href="vignettes.html#organisation"><i class="fa fa-check"></i><b>6.6.1</b> Organisation</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="vignettes.html"><a href="vignettes.html#vignette-cran"><i class="fa fa-check"></i><b>6.7</b> CRAN notes</a></li>
<li class="chapter" data-level="6.8" data-path="vignettes.html"><a href="vignettes.html#where-next"><i class="fa fa-check"></i><b>6.8</b> Where next</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tests.html"><a href="tests.html"><i class="fa fa-check"></i><b>7</b> Testing</a><ul>
<li class="chapter" data-level="7.1" data-path="tests.html"><a href="tests.html#test-workflow"><i class="fa fa-check"></i><b>7.1</b> Test workflow</a></li>
<li class="chapter" data-level="7.2" data-path="tests.html"><a href="tests.html#test-structure"><i class="fa fa-check"></i><b>7.2</b> Test structure</a><ul>
<li class="chapter" data-level="7.2.1" data-path="tests.html"><a href="tests.html#expectations"><i class="fa fa-check"></i><b>7.2.1</b> Expectations</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tests.html"><a href="tests.html#test-tests"><i class="fa fa-check"></i><b>7.3</b> Writing tests</a><ul>
<li class="chapter" data-level="7.3.1" data-path="tests.html"><a href="tests.html#what-to-test"><i class="fa fa-check"></i><b>7.3.1</b> What to test</a></li>
<li class="chapter" data-level="7.3.2" data-path="tests.html"><a href="tests.html#skipping-a-test"><i class="fa fa-check"></i><b>7.3.2</b> Skipping a test</a></li>
<li class="chapter" data-level="7.3.3" data-path="tests.html"><a href="tests.html#building-your-own-testing-tools"><i class="fa fa-check"></i><b>7.3.3</b> Building your own testing tools</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="tests.html"><a href="tests.html#test-files"><i class="fa fa-check"></i><b>7.4</b> Test files</a></li>
<li class="chapter" data-level="7.5" data-path="tests.html"><a href="tests.html#test-cran"><i class="fa fa-check"></i><b>7.5</b> CRAN notes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="namespace.html"><a href="namespace.html"><i class="fa fa-check"></i><b>8</b> Namespace</a><ul>
<li class="chapter" data-level="8.1" data-path="namespace.html"><a href="namespace.html#namespace-motivation"><i class="fa fa-check"></i><b>8.1</b> Motivation</a></li>
<li class="chapter" data-level="8.2" data-path="namespace.html"><a href="namespace.html#search-path"><i class="fa fa-check"></i><b>8.2</b> Search path</a></li>
<li class="chapter" data-level="8.3" data-path="namespace.html"><a href="namespace.html#namespace-NAMESPACE"><i class="fa fa-check"></i><b>8.3</b> The <code>NAMESPACE</code></a></li>
<li class="chapter" data-level="8.4" data-path="namespace.html"><a href="namespace.html#namespace-workflow"><i class="fa fa-check"></i><b>8.4</b> Workflow</a></li>
<li class="chapter" data-level="8.5" data-path="namespace.html"><a href="namespace.html#exports"><i class="fa fa-check"></i><b>8.5</b> Exports</a><ul>
<li class="chapter" data-level="8.5.1" data-path="namespace.html"><a href="namespace.html#export-s3"><i class="fa fa-check"></i><b>8.5.1</b> S3</a></li>
<li class="chapter" data-level="8.5.2" data-path="namespace.html"><a href="namespace.html#export-s4"><i class="fa fa-check"></i><b>8.5.2</b> S4</a></li>
<li class="chapter" data-level="8.5.3" data-path="namespace.html"><a href="namespace.html#export-rc"><i class="fa fa-check"></i><b>8.5.3</b> RC</a></li>
<li class="chapter" data-level="8.5.4" data-path="namespace.html"><a href="namespace.html#export-data"><i class="fa fa-check"></i><b>8.5.4</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="namespace.html"><a href="namespace.html#imports"><i class="fa fa-check"></i><b>8.6</b> Imports</a><ul>
<li class="chapter" data-level="8.6.1" data-path="namespace.html"><a href="namespace.html#import-r"><i class="fa fa-check"></i><b>8.6.1</b> R functions</a></li>
<li class="chapter" data-level="8.6.2" data-path="namespace.html"><a href="namespace.html#import-s3"><i class="fa fa-check"></i><b>8.6.2</b> S3</a></li>
<li class="chapter" data-level="8.6.3" data-path="namespace.html"><a href="namespace.html#import-s4"><i class="fa fa-check"></i><b>8.6.3</b> S4</a></li>
<li class="chapter" data-level="8.6.4" data-path="namespace.html"><a href="namespace.html#import-src"><i class="fa fa-check"></i><b>8.6.4</b> Compiled functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>9</b> External data</a><ul>
<li class="chapter" data-level="9.1" data-path="data.html"><a href="data.html#data-data"><i class="fa fa-check"></i><b>9.1</b> Exported data</a><ul>
<li class="chapter" data-level="9.1.1" data-path="data.html"><a href="data.html#documenting-data"><i class="fa fa-check"></i><b>9.1.1</b> Documenting datasets</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data.html"><a href="data.html#data-sysdata"><i class="fa fa-check"></i><b>9.2</b> Internal data</a></li>
<li class="chapter" data-level="9.3" data-path="data.html"><a href="data.html#data-extdata"><i class="fa fa-check"></i><b>9.3</b> Raw data</a></li>
<li class="chapter" data-level="9.4" data-path="data.html"><a href="data.html#other-data"><i class="fa fa-check"></i><b>9.4</b> Other data</a></li>
<li class="chapter" data-level="9.5" data-path="data.html"><a href="data.html#data-cran"><i class="fa fa-check"></i><b>9.5</b> CRAN notes</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="src.html"><a href="src.html"><i class="fa fa-check"></i><b>10</b> Compiled code</a><ul>
<li class="chapter" data-level="10.1" data-path="src.html"><a href="src.html#cpp"><i class="fa fa-check"></i><b>10.1</b> C++</a><ul>
<li class="chapter" data-level="10.1.1" data-path="src.html"><a href="src.html#cpp-workflow"><i class="fa fa-check"></i><b>10.1.1</b> Workflow</a></li>
<li class="chapter" data-level="10.1.2" data-path="src.html"><a href="src.html#cpp-man"><i class="fa fa-check"></i><b>10.1.2</b> Documentation</a></li>
<li class="chapter" data-level="10.1.3" data-path="src.html"><a href="src.html#cpp-export"><i class="fa fa-check"></i><b>10.1.3</b> Exporting C++ code</a></li>
<li class="chapter" data-level="10.1.4" data-path="src.html"><a href="src.html#cpp-import"><i class="fa fa-check"></i><b>10.1.4</b> Importing C++ code</a></li>
<li class="chapter" data-level="10.1.5" data-path="src.html"><a href="src.html#cpp-best-practices"><i class="fa fa-check"></i><b>10.1.5</b> Best practices</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="src.html"><a href="src.html#clang"><i class="fa fa-check"></i><b>10.2</b> C</a><ul>
<li class="chapter" data-level="10.2.1" data-path="src.html"><a href="src.html#getting-started-with-.call"><i class="fa fa-check"></i><b>10.2.1</b> Getting started with <code>.Call()</code></a></li>
<li class="chapter" data-level="10.2.2" data-path="src.html"><a href="src.html#getting-started-with-.c"><i class="fa fa-check"></i><b>10.2.2</b> Getting started with <code>.C()</code></a></li>
<li class="chapter" data-level="10.2.3" data-path="src.html"><a href="src.html#c-workflow"><i class="fa fa-check"></i><b>10.2.3</b> Workflow</a></li>
<li class="chapter" data-level="10.2.4" data-path="src.html"><a href="src.html#c-export"><i class="fa fa-check"></i><b>10.2.4</b> Exporting C code</a></li>
<li class="chapter" data-level="10.2.5" data-path="src.html"><a href="src.html#c-import"><i class="fa fa-check"></i><b>10.2.5</b> Importing C code</a></li>
<li class="chapter" data-level="10.2.6" data-path="src.html"><a href="src.html#c-best-practices"><i class="fa fa-check"></i><b>10.2.6</b> Best practices</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="src.html"><a href="src.html#src-debugging"><i class="fa fa-check"></i><b>10.3</b> Debugging compiled code</a></li>
<li class="chapter" data-level="10.4" data-path="src.html"><a href="src.html#make"><i class="fa fa-check"></i><b>10.4</b> Makefiles</a></li>
<li class="chapter" data-level="10.5" data-path="src.html"><a href="src.html#src-other"><i class="fa fa-check"></i><b>10.5</b> Other languages</a></li>
<li class="chapter" data-level="10.6" data-path="src.html"><a href="src.html#src-licensing"><i class="fa fa-check"></i><b>10.6</b> Licensing</a></li>
<li class="chapter" data-level="10.7" data-path="src.html"><a href="src.html#src-workflow"><i class="fa fa-check"></i><b>10.7</b> Development workflow</a></li>
<li class="chapter" data-level="10.8" data-path="src.html"><a href="src.html#src-cran"><i class="fa fa-check"></i><b>10.8</b> CRAN issues</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inst.html"><a href="inst.html"><i class="fa fa-check"></i><b>11</b> Installed files</a><ul>
<li class="chapter" data-level="11.1" data-path="inst.html"><a href="inst.html#inst-citation"><i class="fa fa-check"></i><b>11.1</b> Package citation</a></li>
<li class="chapter" data-level="11.2" data-path="inst.html"><a href="inst.html#inst-other-langs"><i class="fa fa-check"></i><b>11.2</b> Other languages</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="misc.html"><a href="misc.html"><i class="fa fa-check"></i><b>12</b> Other components</a><ul>
<li class="chapter" data-level="12.1" data-path="misc.html"><a href="misc.html#demo"><i class="fa fa-check"></i><b>12.1</b> Demos</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>13</b> Git and GitHub</a><ul>
<li class="chapter" data-level="13.1" data-path="git.html"><a href="git.html#git-rstudio"><i class="fa fa-check"></i><b>13.1</b> RStudio, Git and GitHub</a></li>
<li class="chapter" data-level="13.2" data-path="git.html"><a href="git.html#git-setup"><i class="fa fa-check"></i><b>13.2</b> Initial set up</a></li>
<li class="chapter" data-level="13.3" data-path="git.html"><a href="git.html#git-init"><i class="fa fa-check"></i><b>13.3</b> Create a local Git repository</a></li>
<li class="chapter" data-level="13.4" data-path="git.html"><a href="git.html#git-status"><i class="fa fa-check"></i><b>13.4</b> See what’s changed</a></li>
<li class="chapter" data-level="13.5" data-path="git.html"><a href="git.html#git-commit"><i class="fa fa-check"></i><b>13.5</b> Record changes</a></li>
<li class="chapter" data-level="13.6" data-path="git.html"><a href="git.html#commit-best-practices"><i class="fa fa-check"></i><b>13.6</b> Commit best practices</a></li>
<li class="chapter" data-level="13.7" data-path="git.html"><a href="git.html#git-ignore"><i class="fa fa-check"></i><b>13.7</b> Ignoring files</a></li>
<li class="chapter" data-level="13.8" data-path="git.html"><a href="git.html#git-undo"><i class="fa fa-check"></i><b>13.8</b> Undo a mistake</a></li>
<li class="chapter" data-level="13.9" data-path="git.html"><a href="git.html#github-init"><i class="fa fa-check"></i><b>13.9</b> Synchronising with GitHub</a></li>
<li class="chapter" data-level="13.10" data-path="git.html"><a href="git.html#github-benefit"><i class="fa fa-check"></i><b>13.10</b> Benefits of using GitHub</a></li>
<li class="chapter" data-level="13.11" data-path="git.html"><a href="git.html#git-pull"><i class="fa fa-check"></i><b>13.11</b> Working with others</a></li>
<li class="chapter" data-level="13.12" data-path="git.html"><a href="git.html#github-issues"><i class="fa fa-check"></i><b>13.12</b> Issues</a></li>
<li class="chapter" data-level="13.13" data-path="git.html"><a href="git.html#git-branch"><i class="fa fa-check"></i><b>13.13</b> Branches</a></li>
<li class="chapter" data-level="13.14" data-path="git.html"><a href="git.html#git-pullreq"><i class="fa fa-check"></i><b>13.14</b> Making a pull request</a></li>
<li class="chapter" data-level="13.15" data-path="git.html"><a href="git.html#pr-make"><i class="fa fa-check"></i><b>13.15</b> Submitting a pull request to another repo</a></li>
<li class="chapter" data-level="13.16" data-path="git.html"><a href="git.html#pr-accept"><i class="fa fa-check"></i><b>13.16</b> Reviewing and accepting pull requests</a></li>
<li class="chapter" data-level="13.17" data-path="git.html"><a href="git.html#git-learning"><i class="fa fa-check"></i><b>13.17</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="check.html"><a href="check.html"><i class="fa fa-check"></i><b>14</b> Automated checking</a><ul>
<li class="chapter" data-level="14.1" data-path="check.html"><a href="check.html#check-workflow"><i class="fa fa-check"></i><b>14.1</b> Workflow</a></li>
<li class="chapter" data-level="14.2" data-path="check.html"><a href="check.html#check-checks"><i class="fa fa-check"></i><b>14.2</b> Checks</a><ul>
<li class="chapter" data-level="14.2.1" data-path="check.html"><a href="check.html#check-metadata"><i class="fa fa-check"></i><b>14.2.1</b> Check metadata</a></li>
<li class="chapter" data-level="14.2.2" data-path="check.html"><a href="check.html#package-structure-1"><i class="fa fa-check"></i><b>14.2.2</b> Package structure</a></li>
<li class="chapter" data-level="14.2.3" data-path="check.html"><a href="check.html#description-1"><i class="fa fa-check"></i><b>14.2.3</b> Description</a></li>
<li class="chapter" data-level="14.2.4" data-path="check.html"><a href="check.html#namespace-1"><i class="fa fa-check"></i><b>14.2.4</b> Namespace</a></li>
<li class="chapter" data-level="14.2.5" data-path="check.html"><a href="check.html#r-code"><i class="fa fa-check"></i><b>14.2.5</b> R code</a></li>
<li class="chapter" data-level="14.2.6" data-path="check.html"><a href="check.html#data-1"><i class="fa fa-check"></i><b>14.2.6</b> Data</a></li>
<li class="chapter" data-level="14.2.7" data-path="check.html"><a href="check.html#documentation"><i class="fa fa-check"></i><b>14.2.7</b> Documentation</a></li>
<li class="chapter" data-level="14.2.8" data-path="check.html"><a href="check.html#demos"><i class="fa fa-check"></i><b>14.2.8</b> Demos</a></li>
<li class="chapter" data-level="14.2.9" data-path="check.html"><a href="check.html#compiled-code"><i class="fa fa-check"></i><b>14.2.9</b> Compiled code</a></li>
<li class="chapter" data-level="14.2.10" data-path="check.html"><a href="check.html#tests-1"><i class="fa fa-check"></i><b>14.2.10</b> Tests</a></li>
<li class="chapter" data-level="14.2.11" data-path="check.html"><a href="check.html#vignettes-1"><i class="fa fa-check"></i><b>14.2.11</b> Vignettes</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="check.html"><a href="check.html#travis"><i class="fa fa-check"></i><b>14.3</b> Checking after every commit with Travis</a><ul>
<li class="chapter" data-level="14.3.1" data-path="check.html"><a href="check.html#basic-config"><i class="fa fa-check"></i><b>14.3.1</b> Basic config</a></li>
<li class="chapter" data-level="14.3.2" data-path="check.html"><a href="check.html#other-uses"><i class="fa fa-check"></i><b>14.3.2</b> Other uses</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="release.html"><a href="release.html"><i class="fa fa-check"></i><b>15</b> Releasing a package</a><ul>
<li class="chapter" data-level="15.1" data-path="release.html"><a href="release.html#release-version"><i class="fa fa-check"></i><b>15.1</b> Version number</a></li>
<li class="chapter" data-level="15.2" data-path="release.html"><a href="release.html#compatibility"><i class="fa fa-check"></i><b>15.2</b> Backward compatibility</a></li>
<li class="chapter" data-level="15.3" data-path="release.html"><a href="release.html#release-check"><i class="fa fa-check"></i><b>15.3</b> The submission process</a><ul>
<li class="chapter" data-level="15.3.1" data-path="release.html"><a href="release.html#release-test-env"><i class="fa fa-check"></i><b>15.3.1</b> Test environments</a></li>
<li class="chapter" data-level="15.3.2" data-path="release.html"><a href="release.html#release-check"><i class="fa fa-check"></i><b>15.3.2</b> Check results</a></li>
<li class="chapter" data-level="15.3.3" data-path="release.html"><a href="release.html#release-deps"><i class="fa fa-check"></i><b>15.3.3</b> Reverse dependencies</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="release.html"><a href="release.html#cran-policies"><i class="fa fa-check"></i><b>15.4</b> CRAN policies</a></li>
<li class="chapter" data-level="15.5" data-path="release.html"><a href="release.html#important-files"><i class="fa fa-check"></i><b>15.5</b> Important files</a><ul>
<li class="chapter" data-level="15.5.1" data-path="release.html"><a href="release.html#readme"><i class="fa fa-check"></i><b>15.5.1</b> README.md</a></li>
<li class="chapter" data-level="15.5.2" data-path="release.html"><a href="release.html#readme-rmd"><i class="fa fa-check"></i><b>15.5.2</b> README.Rmd</a></li>
<li class="chapter" data-level="15.5.3" data-path="release.html"><a href="release.html#news"><i class="fa fa-check"></i><b>15.5.3</b> NEWS.md</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="release.html"><a href="release.html#release-submission"><i class="fa fa-check"></i><b>15.6</b> Release</a><ul>
<li class="chapter" data-level="15.6.1" data-path="release.html"><a href="release.html#on-failure"><i class="fa fa-check"></i><b>15.6.1</b> On failure</a></li>
<li class="chapter" data-level="15.6.2" data-path="release.html"><a href="release.html#binary-builds"><i class="fa fa-check"></i><b>15.6.2</b> Binary builds</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="release.html"><a href="release.html#post-release"><i class="fa fa-check"></i><b>15.7</b> Prepare for next version</a></li>
<li class="chapter" data-level="15.8" data-path="release.html"><a href="release.html#promotion"><i class="fa fa-check"></i><b>15.8</b> Publicising your package</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="congratulations.html"><a href="congratulations.html"><i class="fa fa-check"></i><b>16</b> Congratulations!</a></li>
<li class="divider"></li>
<li><a href="https://github.com/hadley/r-pkgs/" target="blank">PBuilding R package - Hadley Wickham</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R packages</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="namespace" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Namespace</h1>
<p>The package namespace (as recorded in the <code>NAMESPACE</code> file) is one of the more confusing parts of building a package. It’s a fairly advanced topic, and by-and-large, not that important if you’re only developing packages for yourself. However, understanding namespaces is vital if you plan to submit your package to CRAN. This is because CRAN requires that your package plays nicely with other packages.</p>
<p>When you first start using namespaces, it’ll seem like a lot of work for little gain. However, having a high quality namespace helps encapsulate your package and makes it self-contained. This ensures that other packages won’t interfere with your code, that your code won’t interfere with other packages, and that your package works regardless of the environment in which it’s run.</p>
<div id="namespace-motivation" class="section level2">
<h2><span class="header-section-number">8.1</span> Motivation</h2>
<p>As the name suggests, namespaces provide “spaces” for “names”. They provide a context for looking up the value of an object associated with a name.</p>
<p>Without knowing it, you’ve probably already used namespaces. For example, have you ever used the <code>::</code> operator? It disambiguates functions with the same name. For example, both plyr and Hmisc provide a <code>summarize()</code> function. If you load plyr, then Hmisc, <code>summarize()</code> will refer to the Hmisc version. But if you load the packages in the opposite order, <code>summarize()</code> will refer to the plyr version. This can be confusing. Instead, you can explicitly refer to specific functions: <code>Hmisc::summarize()</code> and <code>plyr::summarize()</code>. Then the order in which the packages are loaded won’t matter.</p>
<p>Namespaces make your packages self-contained in two ways: the <strong>imports</strong> and the <strong>exports</strong>. The <strong>imports</strong> defines how a function in one package finds a function in another. To illustrate, consider what happens when someone changes the definition of a function that you rely on: for example, the simple <code>nrow()</code> function in base R:</p>
<pre class="sourceCode r"><code class="sourceCode r">nrow</code></pre>
<pre><code>## function (x) 
## dim(x)[1L]
## &lt;bytecode: 0x7f9559207110&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>It’s defined in terms of <code>dim()</code>. So what will happen if we override <code>dim()</code>
with our own definition? Does <code>nrow()</code> break?</p>
<pre class="sourceCode r"><code class="sourceCode r">dim &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)
<span class="kw">dim</span>(mtcars)</code></pre>
<pre><code>## [1] 1 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(mtcars)</code></pre>
<pre><code>## [1] 32</code></pre>
<p>Surprisingly, it does not! That’s because when <code>nrow()</code> looks for an object
called <code>dim()</code>, it uses the package namespace, so it finds <code>dim()</code> in
the base environment, not the <code>dim()</code> we created in the global environment.</p>
<p>The <strong>exports</strong> helps you avoid conflicts with other packages by specifying which functions are available outside of your package (internal functions are available only within your package and can’t easily be used by another package). Generally, you want to export a minimal set of functions; the fewer you export, the smaller the chance of a conflict. While conflicts aren’t the end of the world because you can always use <code>::</code> to disambiguate, they’re best avoided where possible because it makes the lives of your users easier.</p>
</div>
<div id="search-path" class="section level2">
<h2><span class="header-section-number">8.2</span> Search path</h2>
<p>To understand why namespaces are important, you need a solid understanding of search paths. To call a function, R first has to find it. R does this by first looking in the global environment. If R doesn’t find it there, it looks in the search path, the list of all the packages you have <strong>attached</strong>. You can see this list by running <code>search()</code>. For example, here’s the search path for the code in this book:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">search</span>()</code></pre>
<pre><code>##  [1] &quot;.GlobalEnv&quot;           &quot;package:nycflights13&quot; &quot;package:lubridate&quot;   
##  [4] &quot;package:stringr&quot;      &quot;package:testthat&quot;     &quot;package:roxygen2&quot;    
##  [7] &quot;package:shiny&quot;        &quot;tools:rstudio&quot;        &quot;package:stats&quot;       
## [10] &quot;package:graphics&quot;     &quot;package:grDevices&quot;    &quot;package:utils&quot;       
## [13] &quot;package:datasets&quot;     &quot;package:methods&quot;      &quot;Autoloads&quot;           
## [16] &quot;package:base&quot;</code></pre>
<p>There’s an important difference between loading and attaching a package. Normally when you talk about loading a package you think of <code>library()</code>, but that actually attaches the package.</p>
<p>If a package is installed,</p>
<ul>
<li><p><strong>Loading</strong> will load code, data and any DLLs; register S3 and
S4 methods; and run the <code>.onLoad()</code> function. After loading, the
package is available in memory, but because it’s not in the search
path, you won’t be able to access its components without using <code>::</code>.
Confusingly, <code>::</code> will also load a package automatically if it
isn’t already loaded. It’s rare to load a package explicitly, but you
can do so with <code>requireNamespace()</code> or <code>loadNamespace()</code>.</p></li>
<li><p><strong>Attaching</strong> puts the package in the search path. You can’t attach a
package without first loading it, so both <code>library()</code> or <code>require()</code> load
then attach the package. You can see the currently attached packages with
<code>search()</code>.</p></li>
</ul>
<p>If a package isn’t installed, loading (and hence attaching) will fail with an error.</p>
<p>To see the differences more clearly, consider two ways of running <code>expect_that()</code> from the testthat package. If we use <code>library()</code>, testthat is attached to the search path. If we use <code>::</code>, it’s not.</p>
<pre class="sourceCode r"><code class="sourceCode r">old &lt;-<span class="st"> </span><span class="kw">search</span>()
testthat<span class="op">::</span><span class="kw">expect_equal</span>(<span class="dv">1</span>, <span class="dv">1</span>)
<span class="kw">setdiff</span>(<span class="kw">search</span>(), old)</code></pre>
<pre><code>## character(0)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">expect_true</span>(<span class="ot">TRUE</span>)
    
<span class="kw">library</span>(testthat)
<span class="kw">expect_equal</span>(<span class="dv">1</span>, <span class="dv">1</span>)
<span class="kw">setdiff</span>(<span class="kw">search</span>(), old)</code></pre>
<pre><code>## character(0)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">expect_true</span>(<span class="ot">TRUE</span>)</code></pre>
<p>There are four functions that make a package available. They differ based on whether they load or attach, and what happens if the package is not found (i.e., throws an error or returns FALSE).</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Throws error</th>
<th>Returns <code>FALSE</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Load</td>
<td><code>loadNamespace(&quot;x&quot;)</code></td>
<td><code>requireNamespace(&quot;x&quot;, quietly = TRUE)</code></td>
</tr>
<tr class="even">
<td>Attach</td>
<td><code>library(x)</code></td>
<td><code>require(x, quietly = TRUE)</code></td>
</tr>
</tbody>
</table>
<p>Of the four, you should only ever use two:</p>
<ul>
<li><p>Use <code>library(x)</code> in data analysis scripts. It will throw an error if the
package is not installed, and will terminate the script. You want to attach
the package to save typing. Never use <code>library()</code> in a package.</p></li>
<li><p>Use <code>requireNamespace(x, quietly = TRUE)</code> inside a package if you want a
specific action (e.g. throw an error) depending on whether or not
a suggested package is installed.</p></li>
</ul>
<p>You never need to use <code>require()</code> (<code>requireNamespace()</code> is almost always better), or <code>loadNamespace()</code> (which is only needed for internal R code). You should never use <code>require()</code> or <code>library()</code> in a package: instead, use the <code>Depends</code> or <code>Imports</code> fields in the <code>DESCRIPTION</code>.</p>
<p>Now’s a good time to come back to an important issue which we glossed over earlier. What’s the difference between <code>Depends</code> and <code>Imports</code> in the <code>DESCRIPTION</code>? When should you use one or the other?</p>
<p>Listing a package in either <code>Depends</code> or <code>Imports</code> ensures that it’s installed when needed. The main difference is that where <code>Imports</code> just <em>loads</em> the package, <code>Depends</code> <em>attaches</em> it. There are no other differences. The rest of the advice in this chapter applies whether or not the package is in <code>Depends</code> or <code>Imports</code>.</p>
<p>Unless there is a good reason otherwise, you should always list packages in <code>Imports</code> not <code>Depends</code>. That’s because a good package is self-contained, and minimises changes to the global environment (including the search path). The only exception is if your package is designed to be used in conjunction with another package. For example, the <a href="https://github.com/gavinsimpson/analogue">analogue</a> package builds on top of <a href="https://github.com/vegandevs/vegan">vegan</a>. It’s not useful without vegan, so it has vegan in <code>Depends</code> instead of <code>Imports</code>. Similarly, ggplot2 should really <code>Depend</code> on scales, rather than <code>Import</code>ing it.</p>
<p>Now that you understand the importance of the namespace, let’s dive into the nitty gritty details. The two sides of the package namespace, imports and exports, are both described by the <code>NAMESPACE</code>. You’ll learn what this file looks like in the next section. In the section after that, you’ll learn the details of exporting and importing functions and other objects.</p>
</div>
<div id="namespace-NAMESPACE" class="section level2">
<h2><span class="header-section-number">8.3</span> The <code>NAMESPACE</code></h2>
<p>The following code is an excerpt of the <code>NAMESPACE</code> file from the testthat package.</p>
<pre><code># Generated by roxygen2 (4.0.2): do not edit by hand
S3method(as.character,expectation)
S3method(compare,character)
export(auto_test)
export(auto_test_package)
export(colourise)
export(context)
exportClasses(ListReporter)
exportClasses(MinimalReporter)
importFrom(methods,setRefClass)
useDynLib(testthat,duplicate_)
useDynLib(testthat,reassign_function)</code></pre>
<p>You can see that the <code>NAMESPACE</code> file looks a bit like R code. Each line contains a <strong>directive</strong>: <code>S3method()</code>, <code>export()</code>, <code>exportClasses()</code>, and so on. Each directive describes an R object, and says whether it’s exported from this package to be used by others, or it’s imported from another package to be used locally.</p>
<p>In total, there are eight namespace directives. Four describe exports:</p>
<ul>
<li><code>export()</code>: export functions (including S3 and S4 generics).</li>
<li><code>exportPattern()</code>: export all functions that match a pattern.</li>
<li><code>exportClasses()</code>, <code>exportMethods()</code>: export S4 classes and methods.</li>
<li><code>S3method()</code>: export S3 methods.</li>
</ul>
<p>And four describe imports:</p>
<ul>
<li><code>import()</code>: import all functions from a package.</li>
<li><code>importFrom()</code>: import selected functions (including S4 generics).</li>
<li><code>importClassesFrom()</code>, <code>importMethodsFrom()</code>: import S4 classes and methods.</li>
<li><code>useDynLib()</code>: import a function from C. This is described in more
detail in <a href="src.html#src">compiled code</a>.</li>
</ul>
<p>I don’t recommend writing these directives by hand. Instead, in this chapter you’ll learn how to generate the <code>NAMESPACE</code> file with roxygen2. There are three main advantages to using roxygen2:</p>
<ul>
<li><p>Namespace definitions live next to its associated function, so when you
read the code it’s easier to see what’s being imported and exported.</p></li>
<li><p>Roxygen2 abstracts away some of the details of <code>NAMESPACE</code>. You only
need to learn one tag, <code>@export</code>, which will automatically generate the right
directive for functions, S3 methods, S4 methods and S4 classes.</p></li>
<li><p>Roxygen2 makes <code>NAMESPACE</code> tidy. No matter how many times you use
<code>@importFrom foo bar</code> you’ll only get one <code>importFrom(foo, bar)</code> in your
<code>NAMESPACE</code>. This makes it easy to attach import directives to every function
that need them, rather than trying to manage in one central place.</p></li>
</ul>
<p>Note that you can choose to use roxygen2 to generate just <code>NAMESPACE</code>, just <code>man/*.Rd</code>, or both. If you don’t use any namespace related tags, roxygen2 won’t touch <code>NAMESPACE</code>. If you don’t use any documentation related tags, roxygen2 won’t touch <code>man/</code>.</p>
</div>
<div id="namespace-workflow" class="section level2">
<h2><span class="header-section-number">8.4</span> Workflow</h2>
<p>Generating the namespace with roxygen2 is just like generating function documentation with roxygen2. You use roxygen2 blocks (starting with <code>#'</code>) and tags (starting with <code>@</code>). The workflow is the same:</p>
<ol style="list-style-type: decimal">
<li><p>Add roxygen comments to your <code>.R</code> files.</p></li>
<li><p>Run <code>devtools::document()</code> (or press Ctrl/Cmd + Shift + D in RStudio) to
convert roxygen comments to <code>.Rd</code> files.</p></li>
<li><p>Look at <code>NAMESPACE</code> and run tests to check that the specification is
correct.</p></li>
<li><p>Rinse and repeat until the correct functions are exported.</p></li>
</ol>
</div>
<div id="exports" class="section level2">
<h2><span class="header-section-number">8.5</span> Exports</h2>
<p>For a function to be usable outside of your package, you must <strong>export</strong> it. When you create a new package with <code>devtools::create()</code>, it produces a temporary <code>NAMESPACE</code> that exports everything in your package that doesn’t start with <code>.</code> (a single period). If you’re just working locally, it’s fine to export everything in your package. However, if you’re planning on sharing your package with others, it’s a really good idea to only export needed functions. This reduces the chances of a conflict with another package.</p>
<p>To export an object, put <code>@export</code> in its roxygen block. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; @export</span>
foo &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, z) {
  ...
}</code></pre>
<p>This will then generate <code>export()</code>, <code>exportMethods()</code>, <code>exportClass()</code> or <code>S3method()</code> depending on the type of the object.</p>
<p>You export functions that you want other people to use. Exported functions must be documented, and you must be cautious when changing their interface — other people are using them! Generally, it’s better to export too little than too much. It’s easy to export things that you didn’t before; it’s hard to stop exporting a function because it might break existing code. Always err on the side of caution, and simplicity. It’s easier to give people more functionality than it is to take away stuff they’re used to.</p>
<p>I believe that packages that have a wide audience should strive to do one thing and do it well. All functions in a package should be related to a single problem (or a set of closely related problems). Any functions not related to that purpose should not be exported. For example, most of my packages have a <code>utils.R</code> file that contains many small functions that are useful for me, but aren’t part of the core purpose of those packages. I never export these functions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Defaults for NULL values</span>
<span class="st">`</span><span class="dt">%||%</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="cf">function</span>(a, b) <span class="cf">if</span> (<span class="kw">is.null</span>(a)) b <span class="cf">else</span> a

<span class="co"># Remove NULLs from a list</span>
compact &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  x[<span class="op">!</span><span class="kw">vapply</span>(x, is.null, <span class="kw">logical</span>(<span class="dv">1</span>))]
}</code></pre>
<p>That said, if you’re creating a package for yourself, it’s far less important to be so disciplined. Because you know what’s in your package, it’s fine to have a local “misc” package that contains a passel of functions that you find useful. But I don’t think you should release such a package.</p>
<p>The following sections describe what you should export if you’re using S3, S4 or RC.</p>
<div id="export-s3" class="section level3">
<h3><span class="header-section-number">8.5.1</span> S3</h3>
<p>If you want others to be able to create instances of an S3 class, <code>@export</code> the constructor function. S3 generics are just regular R functions, you can <code>@export</code> them like functions.</p>
<p>S3 methods represent the most complicated case because there are four different scenarios:</p>
<ul>
<li><p>A method for an exported generic: export every method.</p></li>
<li><p>A method for an internal generic: technically, you don’t need to export
these methods. However, I recommend exporting every S3 method you write
because it’s simpler and makes it less likely that you’ll introduce hard to
find bugs. Use <code>devtools::missing_s3()</code> to list all S3 methods that
you’ve forgotten to export.</p></li>
<li><p>A method for a generic in a required package. You’ll need to import the
generic (see below), and export the method.</p></li>
<li><p>A method for a generic in a suggested package. Namespace directives must
refer to available functions, so they can not reference suggested packages.
It’s possible to use package hooks and code to add this at run-time,
but this is sufficiently complicated that I currently wouldn’t recommend it.
Instead, you’ll have to design your package dependencies in a way that avoids this
scenario.</p></li>
</ul>
</div>
<div id="export-s4" class="section level3">
<h3><span class="header-section-number">8.5.2</span> S4</h3>
<p>S4 classes: if you want others to be able to extend your class, <code>@export</code> it.
If you want others to create instances of your class but not to extend it,
<code>@export</code> the constructor function, not the class.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Can extend and create with new(&quot;A&quot;, ...)</span>
<span class="co">#&#39; @export</span>
<span class="kw">setClass</span>(<span class="st">&quot;A&quot;</span>)

<span class="co"># Can extend and create with new(&quot;B&quot;, ...). You can use B()</span>
<span class="co"># to construct instances in your own code, but others can not</span>
<span class="co">#&#39; @export</span>
B &lt;-<span class="st"> </span><span class="kw">setClass</span>(<span class="st">&quot;B&quot;</span>)

<span class="co"># Can create with C(...) and new(&quot;C&quot;, ...), but can&#39;t create</span>
<span class="co"># a subclass that extends C</span>
<span class="co">#&#39; @export C</span>
C &lt;-<span class="st"> </span><span class="kw">setClass</span>(<span class="st">&quot;C&quot;</span>)

<span class="co"># Can extend and create with D(...) or new(&quot;D&quot;, ...)</span>
<span class="co">#&#39; @export D</span>
<span class="co">#&#39; @exportClass D</span>
D &lt;-<span class="st"> </span><span class="kw">setClass</span>(<span class="st">&quot;D&quot;</span>)</code></pre>
<p>S4 generics: <code>@export</code> if you want the generic to be publicly usable.</p>
<p>S4 methods: you only need to <code>@export</code> methods for generics that you did not define. But I think it’s a good idea to <code>@export</code> every method: that way you don’t need to remember whether or not you created the generic.</p>
</div>
<div id="export-rc" class="section level3">
<h3><span class="header-section-number">8.5.3</span> RC</h3>
<p>The principles used for S4 classes apply here. Note that due to the way that RC is currently implemented, it’s typically impossible for your classes to be extended outside of your package.</p>
</div>
<div id="export-data" class="section level3">
<h3><span class="header-section-number">8.5.4</span> Data</h3>
<p>As you’ll learn about in <a href="data.html#data">data</a>, files that live in <code>data/</code> don’t use the usual namespace mechanism and don’t need to be exported.</p>
</div>
</div>
<div id="imports" class="section level2">
<h2><span class="header-section-number">8.6</span> Imports</h2>
<p><code>NAMESPACE</code> also controls which external functions can be used by your package without having to use <code>::</code>.</p>
<p>It’s confusing that both <code>DESCRIPTION</code> (through the <code>Imports</code> field) and
<code>NAMESPACE</code> (through import directives) seem to be involved in imports. This is just an unfortunate choice of names. The <code>Imports</code> field really has nothing to do with functions imported into the namespace: it just makes sure the package is installed when your package is. It doesn’t make functions available. You need to import functions in exactly the same way regardless of whether or not the package is attached.</p>
<p><code>Depends</code> is just a convenience for the user: if your package is attached, it also attaches all packages listed in <code>Depends</code>. If your package is loaded, packages in <code>Depends</code> are loaded, but not attached, so you need to qualify function names with <code>::</code> or specifically import them.</p>
<p>It’s common for packages to be listed in <code>Imports</code> in <code>DESCRIPTION</code>, but not in <code>NAMESPACE</code>. In fact, this is what I recommend: list the package in <code>DESCRIPTION</code> so that it’s installed, then always refer to it explicitly with <code>pkg::fun()</code>. Unless there is a strong reason not to, it’s better to be explicit. It’s a little more work to write, but a lot easier to read when you come back to the code in the future. The converse is not true. Every package mentioned in <code>NAMESPACE</code> must also be present in the <code>Imports</code> or <code>Depends</code> fields.</p>
<div id="import-r" class="section level3">
<h3><span class="header-section-number">8.6.1</span> R functions</h3>
<p>If you are using just a few functions from another package, my recommendation is to note the package name in the <code>Imports:</code> field of the <code>DESCRIPTION</code> file and call the function(s) explicitly using <code>::</code>, e.g., <code>pkg::fun()</code>. Operators can also be imported in a similar manner, e.g., <code>@importFrom magrittr %&gt;%</code>.</p>
<p>If you are using functions repeatedly, you can avoid <code>::</code> by importing the function with <code>@importFrom pkg fun</code>. This also has a small performance benefit, because <code>::</code> adds approximately 5 µs to function evaluation time.</p>
<p>Alternatively, if you are repeatedly using many functions from another package, you can import all of them using <code>@import package</code>. This is the least recommended solution because it makes your code harder to read (you can’t tell where a function is coming from), and if you <code>@import</code> many packages, it increases the chance of conflicting function names.</p>
</div>
<div id="import-s3" class="section level3">
<h3><span class="header-section-number">8.6.2</span> S3</h3>
<p>S3 generics are just functions, so the same rules for functions apply. S3 methods always accompany the generic, so as long as you can access the generic (either implicitly or explicitly), the methods will also be available. In other words, you don’t need to do anything special for S3 methods. As long as you’ve imported the generic, all the methods will also be available.</p>
</div>
<div id="import-s4" class="section level3">
<h3><span class="header-section-number">8.6.3</span> S4</h3>
<p>To use classes defined in another package, place <code>@importClassesFrom package ClassA ClassB ...</code> next to the classes that inherit from the imported classes, or next to the methods that implement a generic for the imported classes.</p>
<p>To use generics defined in another package, place <code>@importMethodsFrom package GenericA GenericB ...</code> next to the methods that use the imported generics.</p>
<p>Since S4 is implemented in the methods package, you need to make sure it’s available. This is easy to overlook because while the method package is always available in the search path when you’re working interactively, it’s not automatically loaded by <code>Rscript</code>, the tool often used to run R from the command line.</p>
<ul>
<li><p>Pre R 3.2.0: <code>Depends: methods</code> in <code>DESCRIPTION</code>.<br />
Post R 3.2.0: <code>Imports: methods</code> in <code>DESCRIPTION</code>.</p></li>
<li><p>Since you’ll being using a lot of functions from <code>methods</code>,
you’ll probably also want to import the complete package with:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; @import methods</span>
<span class="ot">NULL</span></code></pre>
<p>Or you might just want to import the most commonly used functions:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&#39; @importFrom methods setClass setGeneric setMethod setRefClass</span>
<span class="ot">NULL</span></code></pre>
<p>Here I’m documenting “NULL” to make it clear that these directives don’t
apply to just one function. It doesn’t matter where they go, but if you have
package docs, as described in <a href="man.html#man-packages">documenting packages</a>, that’s
a natural place to put them.</p></li>
</ul>
</div>
<div id="import-src" class="section level3">
<h3><span class="header-section-number">8.6.4</span> Compiled functions</h3>
<p>To make C/C++ functions available in R, see <a href="src.html#src">compiled code</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/r-pkgs/edit/master/08-namespace.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
